{"paragraphs":[{"text":"val df = spark.read.json(\"/users/ricardo/Documents/people.json\")","user":"anonymous","dateUpdated":"2018-10-22T01:53:22+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df: org.apache.spark.sql.DataFrame = [age: bigint, name: string]\n"}]},"apps":[],"jobName":"paragraph_1540165896585_-354155976","id":"20181022-015136_1023048422","dateCreated":"2018-10-22T01:51:36+0200","dateStarted":"2018-10-22T01:53:22+0200","dateFinished":"2018-10-22T01:54:27+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:13445"},{"text":"df.show()","user":"anonymous","dateUpdated":"2018-10-22T01:54:57+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-------+\n| age|   name|\n+----+-------+\n|null|Michael|\n|  30|   Andy|\n|  19| Justin|\n+----+-------+\n\n"}]},"apps":[],"jobName":"paragraph_1540166002209_361885459","id":"20181022-015322_669976700","dateCreated":"2018-10-22T01:53:22+0200","dateStarted":"2018-10-22T01:54:57+0200","dateFinished":"2018-10-22T01:54:58+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13446"},{"text":"df.select(df(\"name\"), df(\"age\") + 1).show()","user":"anonymous","dateUpdated":"2018-10-22T01:55:22+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+---------+\n|   name|(age + 1)|\n+-------+---------+\n|Michael|     null|\n|   Andy|       31|\n| Justin|       20|\n+-------+---------+\n\n"}]},"apps":[],"jobName":"paragraph_1540166097077_194961760","id":"20181022-015457_338228856","dateCreated":"2018-10-22T01:54:57+0200","dateStarted":"2018-10-22T01:55:22+0200","dateFinished":"2018-10-22T01:55:24+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13447"},{"text":"df.filter(df(\"age\") > 21).show()","user":"anonymous","dateUpdated":"2018-10-22T01:55:46+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+----+\n|age|name|\n+---+----+\n| 30|Andy|\n+---+----+\n\n"}]},"apps":[],"jobName":"paragraph_1540166122831_220710375","id":"20181022-015522_442990725","dateCreated":"2018-10-22T01:55:22+0200","dateStarted":"2018-10-22T01:55:46+0200","dateFinished":"2018-10-22T01:55:47+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13448"},{"text":"df.groupBy(\"age\").count().show()","user":"anonymous","dateUpdated":"2018-10-22T01:56:03+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-----+\n| age|count|\n+----+-----+\n|  19|    1|\n|null|    1|\n|  30|    1|\n+----+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1540166146489_783433543","id":"20181022-015546_1763033837","dateCreated":"2018-10-22T01:55:46+0200","dateStarted":"2018-10-22T01:56:03+0200","dateFinished":"2018-10-22T01:56:07+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13449"},{"text":"import org.apache.spark.sql._\nimport org.apache.spark.sql.Row\nimport org.apache.spark.sql.types._\nimport spark.implicits._","user":"anonymous","dateUpdated":"2018-10-22T01:56:31+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql._\nimport org.apache.spark.sql.Row\nimport org.apache.spark.sql.types._\nimport spark.implicits._\n"}]},"apps":[],"jobName":"paragraph_1540166163761_745387376","id":"20181022-015603_459309503","dateCreated":"2018-10-22T01:56:03+0200","dateStarted":"2018-10-22T01:56:32+0200","dateFinished":"2018-10-22T01:56:34+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13450"},{"text":"val peopleRDD = spark.sparkContext.textFile(\"/users/ricardo/Documents/people.txt\")","user":"anonymous","dateUpdated":"2018-10-22T01:57:01+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"peopleRDD: org.apache.spark.rdd.RDD[String] = /users/ricardo/Documents/people.txt MapPartitionsRDD[24] at textFile at <console>:33\n"}]},"apps":[],"jobName":"paragraph_1540166191989_-710867705","id":"20181022-015631_160371367","dateCreated":"2018-10-22T01:56:31+0200","dateStarted":"2018-10-22T01:57:01+0200","dateFinished":"2018-10-22T01:57:02+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13451"},{"text":"val schemaString = \"name age\"\nval fields = schemaString.split(\" \").map(fieldName => StructField(fieldName, StringType, nullable = true))\n\nval schema = StructType(fields)","user":"anonymous","dateUpdated":"2018-10-22T01:57:28+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"schemaString: String = name age\nfields: Array[org.apache.spark.sql.types.StructField] = Array(StructField(name,StringType,true), StructField(age,StringType,true))\nschema: org.apache.spark.sql.types.StructType = StructType(StructField(name,StringType,true), StructField(age,StringType,true))\n"}]},"apps":[],"jobName":"paragraph_1540166221868_557498402","id":"20181022-015701_953796260","dateCreated":"2018-10-22T01:57:01+0200","dateStarted":"2018-10-22T01:57:28+0200","dateFinished":"2018-10-22T01:57:30+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13452"},{"text":"val rowRDD = peopleRDD.map(_.split(\",\")).map(attributes => Row(attributes(0), attributes(1).trim))","user":"anonymous","dateUpdated":"2018-10-22T01:57:42+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"rowRDD: org.apache.spark.rdd.RDD[org.apache.spark.sql.Row] = MapPartitionsRDD[26] at map at <console>:35\n"}]},"apps":[],"jobName":"paragraph_1540166248755_-1886558718","id":"20181022-015728_1187290158","dateCreated":"2018-10-22T01:57:28+0200","dateStarted":"2018-10-22T01:57:42+0200","dateFinished":"2018-10-22T01:57:43+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13453"},{"text":"val peopleDF = spark.createDataFrame(rowRDD, schema)","user":"anonymous","dateUpdated":"2018-10-22T01:58:07+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"peopleDF: org.apache.spark.sql.DataFrame = [name: string, age: string]\n"}]},"apps":[],"jobName":"paragraph_1540166262200_-1700830705","id":"20181022-015742_2058855030","dateCreated":"2018-10-22T01:57:42+0200","dateStarted":"2018-10-22T01:58:07+0200","dateFinished":"2018-10-22T01:58:08+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13454"},{"text":"peopleDF.createOrReplaceTempView(\"people\")","user":"anonymous","dateUpdated":"2018-10-22T01:58:18+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1540166287295_-94029873","id":"20181022-015807_123313941","dateCreated":"2018-10-22T01:58:07+0200","dateStarted":"2018-10-22T01:58:18+0200","dateFinished":"2018-10-22T01:58:19+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13455"},{"text":"val results = spark.sql(\"SELECT name FROM people\")","user":"anonymous","dateUpdated":"2018-10-22T01:58:27+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"results: org.apache.spark.sql.DataFrame = [name: string]\n"}]},"apps":[],"jobName":"paragraph_1540166298025_985367511","id":"20181022-015818_1431404720","dateCreated":"2018-10-22T01:58:18+0200","dateStarted":"2018-10-22T01:58:27+0200","dateFinished":"2018-10-22T01:58:28+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13456"},{"text":"results.map(attributes => \"Name: \" + attributes(0)).show()","user":"anonymous","dateUpdated":"2018-10-22T01:58:39+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+\n|        value|\n+-------------+\n|Name: Michael|\n|   Name: Andy|\n| Name: Justin|\n+-------------+\n\n"}]},"apps":[],"jobName":"paragraph_1540166307749_1924430685","id":"20181022-015827_1217555888","dateCreated":"2018-10-22T01:58:27+0200","dateStarted":"2018-10-22T01:58:39+0200","dateFinished":"2018-10-22T01:58:41+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13457"},{"text":"%md\n## Datasets","user":"anonymous","dateUpdated":"2018-10-22T01:59:17+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Datasets</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1540166319905_-622198300","id":"20181022-015839_2118995381","dateCreated":"2018-10-22T01:58:39+0200","dateStarted":"2018-10-22T01:59:17+0200","dateFinished":"2018-10-22T01:59:17+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13458"},{"text":"val ds = Seq(1, 2, 3).toDS()\n\nds.show\n","user":"anonymous","dateUpdated":"2018-10-22T01:59:41+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ds: org.apache.spark.sql.Dataset[Int] = [value: int]\n+-----+\n|value|\n+-----+\n|    1|\n|    2|\n|    3|\n+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1540166345918_-335229148","id":"20181022-015905_132625484","dateCreated":"2018-10-22T01:59:05+0200","dateStarted":"2018-10-22T01:59:41+0200","dateFinished":"2018-10-22T01:59:42+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13459"},{"text":"case class Person(name: String, age: Long)\n\nval ds = Seq(Person(\"Andy\", 32)).toDS()","user":"anonymous","dateUpdated":"2018-10-22T01:59:55+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"defined class Person\nds: org.apache.spark.sql.Dataset[Person] = [name: string, age: bigint]\n"}]},"apps":[],"jobName":"paragraph_1540166381193_710757193","id":"20181022-015941_1834780485","dateCreated":"2018-10-22T01:59:41+0200","dateStarted":"2018-10-22T01:59:55+0200","dateFinished":"2018-10-22T01:59:58+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13460"},{"text":"ds.show","user":"anonymous","dateUpdated":"2018-10-22T02:00:09+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+---+\n|name|age|\n+----+---+\n|Andy| 32|\n+----+---+\n\n"}]},"apps":[],"jobName":"paragraph_1540166395077_1489961905","id":"20181022-015955_559092487","dateCreated":"2018-10-22T01:59:55+0200","dateStarted":"2018-10-22T02:00:09+0200","dateFinished":"2018-10-22T02:00:10+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13461"},{"text":"val path = \"/users/ricardo/Documents/people.json\"\nval people = spark.read.json(path).as[Person] // Creates a DataSet","user":"anonymous","dateUpdated":"2018-10-22T02:00:37+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"path: String = /users/ricardo/Documents/people.json\npeople: org.apache.spark.sql.Dataset[Person] = [age: bigint, name: string]\n"}]},"apps":[],"jobName":"paragraph_1540166409526_-152930315","id":"20181022-020009_981862636","dateCreated":"2018-10-22T02:00:09+0200","dateStarted":"2018-10-22T02:00:37+0200","dateFinished":"2018-10-22T02:00:38+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13462"},{"text":"people.show","user":"anonymous","dateUpdated":"2018-10-22T02:01:22+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-------+\n| age|   name|\n+----+-------+\n|null|Michael|\n|  30|   Andy|\n|  19| Justin|\n+----+-------+\n\n"}]},"apps":[],"jobName":"paragraph_1540166453452_2082688197","id":"20181022-020053_1003564169","dateCreated":"2018-10-22T02:00:53+0200","dateStarted":"2018-10-22T02:01:22+0200","dateFinished":"2018-10-22T02:01:23+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13463"},{"text":"val pplFiltered = people.filter(\"age is not null\")","user":"anonymous","dateUpdated":"2018-10-22T02:01:34+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"pplFiltered: org.apache.spark.sql.Dataset[Person] = [age: bigint, name: string]\n"}]},"apps":[],"jobName":"paragraph_1540166482460_-1990126353","id":"20181022-020122_2069350576","dateCreated":"2018-10-22T02:01:22+0200","dateStarted":"2018-10-22T02:01:34+0200","dateFinished":"2018-10-22T02:01:34+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13464"},{"text":"val pplDS = pplFiltered.as[Person]","user":"anonymous","dateUpdated":"2018-10-22T02:01:48+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"pplDS: org.apache.spark.sql.Dataset[Person] = [age: bigint, name: string]\n"}]},"apps":[],"jobName":"paragraph_1540166494162_-1508513667","id":"20181022-020134_1834253224","dateCreated":"2018-10-22T02:01:34+0200","dateStarted":"2018-10-22T02:01:49+0200","dateFinished":"2018-10-22T02:01:49+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13465"},{"text":"pplDS.show","user":"anonymous","dateUpdated":"2018-10-22T02:02:37+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+------+\n|age|  name|\n+---+------+\n| 30|  Andy|\n| 19|Justin|\n+---+------+\n\n"}]},"apps":[],"jobName":"paragraph_1540166508940_763214472","id":"20181022-020148_1399899943","dateCreated":"2018-10-22T02:01:48+0200","dateStarted":"2018-10-22T02:02:37+0200","dateFinished":"2018-10-22T02:02:38+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13466"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1540166557955_826208482","id":"20181022-020237_711909166","dateCreated":"2018-10-22T02:02:37+0200","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:13467"}],"name":"Dataframes_Datasets","id":"2DV2WRPQZ","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"spark2:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}