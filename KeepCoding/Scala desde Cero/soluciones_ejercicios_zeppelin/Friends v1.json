{"paragraphs":[{"text":"import org.apache.spark._\nimport org.apache.spark.SparkContext._\nimport org.apache.log4j._","user":"anonymous","dateUpdated":"2018-10-22T10:56:34+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark._\nimport org.apache.spark.SparkContext._\nimport org.apache.log4j._\n"}]},"apps":[],"jobName":"paragraph_1540198583717_208733892","id":"20181022-105623_1698957163","dateCreated":"2018-10-22T10:56:23+0200","dateStarted":"2018-10-22T10:56:34+0200","dateFinished":"2018-10-22T10:56:36+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5284"},{"text":"def parseLine(line: String) = {\n      // Split by commas\n      val fields = line.split(\",\")\n      // Extract the age and numFriends fields, and convert to integers\n      val age = fields(2).toInt\n      val numFriends = fields(3).toInt\n      // Create a tuple that is our result.\n      (age, numFriends)\n  }","user":"anonymous","dateUpdated":"2018-10-22T10:56:43+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"parseLine: (line: String)(Int, Int)\n"}]},"apps":[],"jobName":"paragraph_1540198594240_-2055362241","id":"20181022-105634_974564802","dateCreated":"2018-10-22T10:56:34+0200","dateStarted":"2018-10-22T10:56:43+0200","dateFinished":"2018-10-22T10:56:44+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5285"},{"text":"// Create a SparkContext using every core of the local machine\n   // Load each line of the source data into an RDD\n    val lines = sc.textFile(\"file:///Users/ricardo/Documents/friends.csv\")","user":"anonymous","dateUpdated":"2018-10-22T10:57:52+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"lines: org.apache.spark.rdd.RDD[String] = file:///Users/ricardo/Documents/friends.csv MapPartitionsRDD[45] at textFile at <console>:47\n"}]},"apps":[],"jobName":"paragraph_1540198603382_-1875436022","id":"20181022-105643_936003221","dateCreated":"2018-10-22T10:56:43+0200","dateStarted":"2018-10-22T10:57:52+0200","dateFinished":"2018-10-22T10:57:53+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5286"},{"text":"// Use our parseLines function to convert to (age, numFriends) tuples\n    val rdd = lines.map(parseLine)","user":"anonymous","dateUpdated":"2018-10-22T10:58:04+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"rdd: org.apache.spark.rdd.RDD[(Int, Int)] = MapPartitionsRDD[46] at map at <console>:54\n"}]},"apps":[],"jobName":"paragraph_1540198636141_1688529508","id":"20181022-105716_111761147","dateCreated":"2018-10-22T10:57:16+0200","dateStarted":"2018-10-22T10:58:04+0200","dateFinished":"2018-10-22T10:58:05+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5287"},{"text":"val totalsByAge = rdd.mapValues(x => (x, 1)).reduceByKey( (x,y) => (x._1 + y._1, x._2 + y._2))","user":"anonymous","dateUpdated":"2018-10-22T10:58:15+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"totalsByAge: org.apache.spark.rdd.RDD[(Int, (Int, Int))] = ShuffledRDD[48] at reduceByKey at <console>:54\n"}]},"apps":[],"jobName":"paragraph_1540198684025_229613332","id":"20181022-105804_767276720","dateCreated":"2018-10-22T10:58:04+0200","dateStarted":"2018-10-22T10:58:15+0200","dateFinished":"2018-10-22T10:58:16+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5288"},{"text":"// So now we have tuples of (age, (totalFriends, totalInstances))\n    // To compute the average we divide totalFriends / totalInstances for each age.\n    val averagesByAge = totalsByAge.mapValues(x => x._1 / x._2)\n    ","user":"anonymous","dateUpdated":"2018-10-22T10:58:26+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"averagesByAge: org.apache.spark.rdd.RDD[(Int, Int)] = MapPartitionsRDD[49] at mapValues at <console>:59\n"}]},"apps":[],"jobName":"paragraph_1540198695046_-328015025","id":"20181022-105815_2088357557","dateCreated":"2018-10-22T10:58:15+0200","dateStarted":"2018-10-22T10:58:26+0200","dateFinished":"2018-10-22T10:58:27+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5289"},{"text":"// Collect the results from the RDD (This kicks off computing the DAG and actually executes the job)\n    val results = averagesByAge.collect()","user":"anonymous","dateUpdated":"2018-10-22T10:58:34+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"results: Array[(Int, Int)] = Array((34,245), (52,340), (56,306), (66,276), (22,206), (28,209), (54,278), (46,223), (48,281), (30,235), (50,254), (32,207), (36,246), (24,233), (62,220), (64,281), (42,303), (40,250), (18,343), (20,165), (38,193), (58,116), (44,282), (60,202), (26,242), (68,269), (19,213), (39,169), (41,268), (61,256), (21,350), (47,233), (55,295), (53,222), (25,197), (29,215), (59,220), (65,298), (35,211), (27,228), (57,258), (51,302), (33,325), (37,249), (23,246), (45,309), (63,384), (67,214), (69,235), (49,184), (31,267), (43,230))\n"}]},"apps":[],"jobName":"paragraph_1540198706157_2123615812","id":"20181022-105826_19972158","dateCreated":"2018-10-22T10:58:26+0200","dateStarted":"2018-10-22T10:58:34+0200","dateFinished":"2018-10-22T10:58:35+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5290"},{"text":"// Sort and print the final results.\n    results.sorted.foreach(println)","user":"anonymous","dateUpdated":"2018-10-22T10:58:41+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"(18,343)\n(19,213)\n(20,165)\n(21,350)\n(22,206)\n(23,246)\n(24,233)\n(25,197)\n(26,242)\n(27,228)\n(28,209)\n(29,215)\n(30,235)\n(31,267)\n(32,207)\n(33,325)\n(34,245)\n(35,211)\n(36,246)\n(37,249)\n(38,193)\n(39,169)\n(40,250)\n(41,268)\n(42,303)\n(43,230)\n(44,282)\n(45,309)\n(46,223)\n(47,233)\n(48,281)\n(49,184)\n(50,254)\n(51,302)\n(52,340)\n(53,222)\n(54,278)\n(55,295)\n(56,306)\n(57,258)\n(58,116)\n(59,220)\n(60,202)\n(61,256)\n(62,220)\n(63,384)\n(64,281)\n(65,298)\n(66,276)\n(67,214)\n(68,269)\n(69,235)\n"}]},"apps":[],"jobName":"paragraph_1540198714237_25030804","id":"20181022-105834_1691201433","dateCreated":"2018-10-22T10:58:34+0200","dateStarted":"2018-10-22T10:58:42+0200","dateFinished":"2018-10-22T10:58:42+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5291"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1540198721943_-278429146","id":"20181022-105841_1226218039","dateCreated":"2018-10-22T10:58:41+0200","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:5292"}],"name":"Friends v1","id":"2DW473TXH","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"spark2:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}