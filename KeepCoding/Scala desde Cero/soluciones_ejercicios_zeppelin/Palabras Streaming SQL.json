{"paragraphs":[{"text":"import org.apache.spark.SparkConf\nimport org.apache.spark.rdd.RDD\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.storage.StorageLevel\nimport org.apache.spark.streaming.{Seconds, StreamingContext, Time}","user":"anonymous","dateUpdated":"2018-10-24T10:03:18+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.SparkConf\nimport org.apache.spark.rdd.RDD\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.storage.StorageLevel\nimport org.apache.spark.streaming.{Seconds, StreamingContext, Time}\n"}]},"apps":[],"jobName":"paragraph_1540368166412_-1263314099","id":"20181024-100246_1659844237","dateCreated":"2018-10-24T10:02:46+0200","dateStarted":"2018-10-24T10:03:18+0200","dateFinished":"2018-10-24T10:03:19+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7145"},{"text":"val ssc = new StreamingContext(sc, Seconds(2))","user":"anonymous","dateUpdated":"2018-10-24T10:03:51+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ssc: org.apache.spark.streaming.StreamingContext = org.apache.spark.streaming.StreamingContext@4c5cee1f\n"}]},"apps":[],"jobName":"paragraph_1540368175837_156721061","id":"20181024-100255_742564223","dateCreated":"2018-10-24T10:02:55+0200","dateStarted":"2018-10-24T10:03:51+0200","dateFinished":"2018-10-24T10:03:51+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7146"},{"text":"val lines = ssc.socketTextStream(\"127.0.0.1\", 9999, StorageLevel.MEMORY_AND_DISK_SER)\nval words = lines.flatMap(_.split(\" \"))","user":"anonymous","dateUpdated":"2018-10-24T10:04:23+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"lines: org.apache.spark.streaming.dstream.ReceiverInputDStream[String] = org.apache.spark.streaming.dstream.SocketInputDStream@2e36a98b\nwords: org.apache.spark.streaming.dstream.DStream[String] = org.apache.spark.streaming.dstream.FlatMappedDStream@76567583\n"}]},"apps":[],"jobName":"paragraph_1540368231364_-645236369","id":"20181024-100351_598128589","dateCreated":"2018-10-24T10:03:51+0200","dateStarted":"2018-10-24T10:04:23+0200","dateFinished":"2018-10-24T10:04:24+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7147"},{"text":"spark.version","user":"anonymous","dateUpdated":"2018-10-24T10:05:25+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res30: String = 2.3.0\n"}]},"apps":[],"jobName":"paragraph_1540368278858_-333159834","id":"20181024-100438_1743147719","dateCreated":"2018-10-24T10:04:38+0200","dateStarted":"2018-10-24T10:05:25+0200","dateFinished":"2018-10-24T10:05:26+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7148"},{"text":"case class Record(word: String)","user":"anonymous","dateUpdated":"2018-10-24T10:06:47+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"defined class Record\n"}]},"apps":[],"jobName":"paragraph_1540368405480_2032135140","id":"20181024-100645_2022005290","dateCreated":"2018-10-24T10:06:45+0200","dateStarted":"2018-10-24T10:06:47+0200","dateFinished":"2018-10-24T10:06:48+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7149"},{"text":"words.foreachRDD { (rdd: RDD[String], time: Time) =>\n      // Get the singleton instance of SparkSession\n     import spark.implicits._\n\n      // Convert RDD[String] to RDD[case class] to DataFrame\n      val wordsDataFrame = rdd.map(w => Record(w)).toDF()\n\n      // Creates a temporary view using the DataFrame\n      wordsDataFrame.createOrReplaceTempView(\"words\")\n\n      // Do word count on table using SQL and print it\n      val wordCountsDataFrame =\n        spark.sql(\"select word, count(*) as total from words group by word\")\n      println(s\"========= $time =========\")\n      wordCountsDataFrame.show()\n    }","user":"anonymous","dateUpdated":"2018-10-24T10:06:50+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1540368334001_-1248780750","id":"20181024-100534_331740042","dateCreated":"2018-10-24T10:05:34+0200","dateStarted":"2018-10-24T10:06:50+0200","dateFinished":"2018-10-24T10:06:52+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7150"},{"text":"ssc.start()\n    ssc.awaitTermination()","user":"anonymous","dateUpdated":"2018-10-24T10:07:05+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1540368387769_1855263808","id":"20181024-100627_915840748","dateCreated":"2018-10-24T10:06:27+0200","dateStarted":"2018-10-24T10:07:05+0200","status":"ABORT","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7151"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1540368425077_-1228777233","id":"20181024-100705_1804893470","dateCreated":"2018-10-24T10:07:05+0200","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:7152"}],"name":"Palabras Streaming SQL","id":"2DWERDCNR","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark2:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}